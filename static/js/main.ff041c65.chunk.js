(this["webpackJsonpdragon-architect-2"]=this["webpackJsonpdragon-architect-2"]||[]).push([[0],{27:function(e,t,n){},40:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a,i,o,r=n(13),s=n.n(r),c=n(33),l=n.n(c),u=(n(27),n(40),n(16)),d=n(15),h=n(0),p=n(1),m=n(2),f=n(3),v=n(14),g=n(7),b=n(11),_=n.n(b),k=n(10),z=n.n(k),j=n(12),x=n(29),y=["(",")",",","@","="],w=["define","function","set","var","let","mutable","to","in","if","elif","else","end","then","repeat","times","pass","choice","match","case","of","and","or","null","true","false","command","query"],O=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{line:0,column:0},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{line:0,column:0};Object(h.a)(this,e),this.start=void 0,this.end=void 0,this.start=t,this.end=n};function S(e,t){return e.kind===t.kind&&z.a.isEqual(e.value,t.value)&&e.whitespace===t.whitespace}function C(e){return void 0!==e&&1===e.length&&("\t"===e||"\r"===e||" "===e)}function M(e){return void 0!==e&&1===e.length&&("\t"===e||" "===e)}function N(e){return void 0!==e&&/^[A-Z]$/i.test(e)}function P(e){return void 0!==e&&/^[0-9]$/.test(e)}!function(e){e.Indent="indent",e.Dedent="dedent",e.Newline="newline"}(a||(a={})),function(e){e.Whitespace="whitespace",e.Symbol="symbol",e.Keyword="keyword",e.Ident="ident",e.IntLiteral="int"}(i||(i={})),function(e){e[e.UnexpectedEOF=0]="UnexpectedEOF",e[e.InvalidCharacter=1]="InvalidCharacter",e[e.InvalidIndentation=2]="InvalidIndentation",e[e.UnexpectedToken=3]="UnexpectedToken",e[e.InvalidExpression=4]="InvalidExpression",e[e.InvalidStatement=5]="InvalidStatement"}(o||(o={}));var E,A,I=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e,a,i){var o;return Object(h.a)(this,n),(o=t.call(this,i)).code=void 0,o.location=void 0,Object.setPrototypeOf(Object(j.a)(o),n.prototype),o.code=e,o.location=a,o}return n}(Object(x.a)(Error));!function(e){e.Number="number",e.Ident="ident"}(E||(E={})),function(e){e.Repeat="repeat",e.Execute="execute",e.Command="command"}(A||(A={}));var D=function(){function e(t){Object(h.a)(this,e),this.source=void 0,this.position=0,this.indent_stack=[0],this.next_line=0,this.next_column=0,this.source=t}return Object(p.a)(e,[{key:"error",value:function(e,t){var n=this.next_position();return new I(e,{start:n,end:n},t)}},{key:"token",value:function(e,t,n,a){var o={kind:e,value:t,location:{start:n,end:this.next_position()}};return e===i.Whitespace&&(o.whitespace=a),o}},{key:"last_indent",value:function(){return z.a.last(this.indent_stack)}},{key:"next_position",value:function(){return{line:this.next_line,column:this.next_column}}},{key:"advance",value:function(){return this.position<this.source.length?this.source[this.position++]:this.error(o.UnexpectedEOF,"Unexpected end of file")}},{key:"peek_char",value:function(){return this.position<this.source.length?this.source[this.position]:this.error(o.UnexpectedEOF,"Unexpected end of file")}},{key:"is_eof",value:function(){return this.position>=this.source.length}},{key:"next_char",value:function(){var e=this.advance();if(e instanceof I)return e;switch(e){case"\n":this.next_line+=1,this.next_column=0;break;default:this.next_column+=1}return e}},{key:"build_string",value:function(e,t){for(var n=this.peek_char();!(n instanceof I)&&t(n);)e+=this.next_char(),n=this.peek_char();return e}},{key:"lex_token",value:function(){var e=this.next_position(),t=this.next_char();if(t instanceof I)return t;if(N(t)||"_"===t){var n=this.build_string(t,(function(e){return N(e)||P(e)||"_"===e}));return w.includes(n)?this.token(i.Keyword,n,e):this.token(i.Ident,{name:n},e)}if(P(t)){var a=this.build_string(t,(function(e){return P(e)}));return this.token(i.IntLiteral,parseInt(a),e)}return y.includes(t)?this.token(i.Symbol,t,e):this.error(o.InvalidCharacter,"Invalid character '".concat(t,"'"))}},{key:"skip_whitespace",value:function(){for(var e=0,t=this.peek_char();!(t instanceof I)&&C(t);)M(t)&&(e+=1),this.next_char(),t=this.peek_char();return e}},{key:"skip_comment",value:function(){var e=this.peek_char();if(this.is_eof()||"#"===e||"\n"===e){for(;!this.is_eof()&&"\n"!==this.peek_char();)this.next_char();return this.is_eof()||this.next_char(),!0}return!1}},{key:"lex_line",value:function(e){var t=this.next_position(),n=this.skip_whitespace();if(!this.skip_comment()){if(n>this.last_indent())this.indent_stack.push(n),e.push(this.token(i.Whitespace,"",t,a.Indent));else{for(;n<this.last_indent();)e.push(this.token(i.Whitespace,"",t,a.Dedent)),this.indent_stack.pop();if(n!==this.last_indent())return this.error(o.InvalidIndentation,"Invalid indentation level")}for(;!this.skip_comment();){var r=this.lex_token();if(r instanceof I)return r;e.push(r),this.skip_whitespace()}e.push(this.token(i.Whitespace,"",t,a.Newline))}}},{key:"lex_all",value:function(){for(var e=[];!this.is_eof();){var t=this.lex_line(e);if(t instanceof I)return t}for(var n=1;n<this.indent_stack.length;n++)e.push(this.token(i.Whitespace,"",this.next_position(),a.Dedent));return e}}]),e}(),T=function(){function e(t){Object(h.a)(this,e),this.tokens=void 0,this.last_location=void 0,this.tokens=z.a.reverse(t),this.last_location=new O}return Object(p.a)(e,[{key:"error",value:function(e,t){return new I(e,this.last_location,t)}},{key:"make_check_token",value:function(e,t){return{kind:e,value:t,location:new O}}},{key:"make_ws_token",value:function(e){return{kind:i.Whitespace,value:"",location:new O,whitespace:e}}},{key:"next_location",value:function(){return this.tokens.length>0?z.a.last(this.tokens).location:new O}},{key:"next",value:function(){var e=this.tokens.pop();return void 0!==e?(this.last_location=e.location,e):this.error(o.UnexpectedEOF,"Unexpected end of file")}},{key:"match_token",value:function(e){var t=this.next();return t instanceof I?t:S(t,e)?void 0:this.error(o.UnexpectedToken,"Expected token ".concat(JSON.stringify(e),", found ").concat(t.kind))}},{key:"peek_token",value:function(e){var t=z.a.last(this.tokens);return void 0!==t&&S(t,e)}},{key:"new_meta",value:function(e,t){return{location:new O(e.start,this.last_location.end),attributes:t||new Map}}},{key:"match_ident",value:function(){var e=this.next();return e instanceof I?e:e.kind===i.Ident?e.value.name:this.error(o.UnexpectedToken,"Expected identifier, found ".concat(e.kind))}},{key:"match_expression",value:function(){var e,t,n=this.next_location(),a=this.next();if(a instanceof I)return a;switch(a.kind){case i.IntLiteral:t=a.value,e=E.Number;break;case i.Ident:t=a.value,e=E.Ident;break;default:return this.error(o.InvalidExpression,"Expected an expression which must start with an identifier or a literal")}return{kind:e,meta:this.new_meta(n),expression:t}}},{key:"match_paren_list",value:function(e){var t=this.match_token(this.make_check_token(i.Symbol,"("));if(t instanceof I)return t;for(var n=[];!this.peek_token(this.make_check_token(i.Symbol,")"));){var a=e();if(a instanceof I)return a;if(n.push(a),!this.peek_token(this.make_check_token(i.Symbol,",")))break;if((t=this.match_token(this.make_check_token(i.Symbol,",")))instanceof I)return t}return(t=this.match_token(this.make_check_token(i.Symbol,")")))instanceof I?t:n}},{key:"match_invocation",value:function(e){if(void 0===e){var t=this.match_ident();if(t instanceof I)return t;e=t}var n=this.match_paren_list(this.match_expression.bind(this));if(n instanceof I)return n;var i=this.match_token(this.make_ws_token(a.Newline));return i instanceof I?i:{name:e,args:n}}},{key:"match_attributes",value:function(){for(var e=new Map;this.peek_token(this.make_check_token(i.Symbol,"@"));){var t=this.next();if(t instanceof I)return t;var n=this.match_ident();if(n instanceof I)return n;var o=this.match_token(this.make_check_token(i.Symbol,"="));if(o instanceof I)return o;var r=this.match_ident();if(r instanceof I)return r;var s=this.match_token(this.make_ws_token(a.Newline));if(s instanceof I)return s;e.set(n,r)}return e}},{key:"match_statement",value:function(e){var t=this.next_location(),n=this.next();if(n instanceof I)return n;var r=this.new_meta(t,e);switch(n.kind){case i.Keyword:switch(n.value){case"pass":var s=this.match_token(this.make_ws_token(a.Newline));return s instanceof I?s:null;case"repeat":var c=this.match_repeat();return c instanceof I?c:{kind:A.Repeat,meta:r,stmt:c};case"command":var l=this.match_invocation();return l instanceof I?l:{kind:A.Command,meta:r,stmt:{invoke:l}};default:return this.error(o.InvalidStatement,"Keyword ".concat(n.value," not recognized"))}case i.Ident:var u=this.match_invocation(n.value.name);return u instanceof I?u:{kind:A.Execute,meta:r,stmt:{invoke:u}};default:return this.error(o.InvalidStatement,"Expected a statement, which must start with if, repeat, command, or an identifier")}}},{key:"match_block",value:function(){var e=this.match_token(this.make_ws_token(a.Newline));if(e instanceof I)return e;if((e=this.match_token(this.make_ws_token(a.Indent)))instanceof I)return e;for(var t=[];!this.peek_token(this.make_ws_token(a.Dedent));){var n=this.match_statement();if(n instanceof I)return n;if(null===n)break;t.push(n)}var i=this.next();return i instanceof I?i:t}},{key:"match_repeat",value:function(){var e=this.match_expression();if(e instanceof I)return e;var t=this.match_token(this.make_check_token(i.Keyword,"times"));if(t instanceof I)return t;var n=this.match_block();return n instanceof I?n:{number:e,body:n}}},{key:"match_procedure",value:function(e){var t=this.next_location(),n=this.match_token(this.make_check_token(i.Keyword,"define"));if(n instanceof I)return n;var a=this.match_ident();if(a instanceof I)return a;var o=this.match_paren_list(this.match_ident.bind(this));if(o instanceof I)return o;var r=this.match_block();return r instanceof I?r:{kind:"procedure",meta:this.new_meta(t,e),name:a,params:o,body:r}}},{key:"match_top_level_statement",value:function(){var e=this.match_attributes();if(e instanceof I)return e;if(this.peek_token(this.make_check_token(i.Keyword,"define")))return this.match_procedure(e);var t=this.match_statement(e);return t instanceof I&&t.code===o.InvalidStatement?new I(t.code,t.location,"Expected a top-level statement, which must start with define, if, repeat, command, or an identifier"):t}},{key:"match_program",value:function(){for(var e=[];this.tokens.length>0;){var t=this.match_top_level_statement();if(t instanceof I)return t;null!==t&&e.push(t)}return{body:e}}}]),e}(),U={body:[]};function R(e){var t=new D(e).lex_all();return t instanceof I?(console.error("[SyntaxError] ".concat(t)),t):new T(t).match_program()}var F=n(17);F.Block.prototype.getNested=function(){for(var e,t=[],n=0;e=this.inputList[n];n++)if(e.connection){var a=e.connection.targetBlock();a&&t.push(a)}return t},F.Block.prototype.freeze=function(e){(this.frozen=!0,this.setMovable(!1),this.setDeletable(!1),this.contextMenu=!1,e&&this.setEditable(!1),this.inputsInline)&&this.inputList.filter((function(e){return e.type===F.INPUT_VALUE})).forEach((function(t){t.connection.targetBlock().freeze(e)}))};var L=n(4),V="#0075A6",B="#B84B26",q="#978B63",W=["math_number"],G=new Map;function H(e,t){if(0===e.length)return"";switch(e[0].kind){case"procedure":var n="";n=H(e[0].body,n),n='<block type = "procedures_defnoreturn"><field name="NAME">'+e[0].name+'</field><statement name="STACK">'+n,t+=n+="</statement></block>";break;default:var a=function(e){switch(e.kind){case A.Command:case A.Execute:return e.stmt.invoke;default:return null}}(e[0]);if(a)if("Left"===a.name||"Right"===a.name||"RemoveCube"===a.name){if(1===e.length)return'<block type="'+a.name+'"></block>';t='<block type="'+a.name+'"><next>'+H(e.slice(1),"")+"</next></block>"}else if("PlaceCube"===a.name){var i=a.args,o=0;if(i[0].kind===E.Number&&(o=i[0].expression),1===e.length)return'<block type="'+a.name+'"><field name="VALUE">'+_.a.FieldColour.COLOURS[o]+"</field></block>";t='<block type="'+a.name+'"><field name="VALUE">'+_.a.FieldColour.COLOURS[o]+"</field><next>"+H(e.slice(1),"")+"</next></block>"}else{var r=a.args;if(r[0].kind===E.Number){if(1===e.length)return'<block type="'+a.name+'"><value name="VALUE">'+X(r[0].expression)+"</value></block>";t='<block type="'+a.name+'"><value name="VALUE">'+X(r[0].expression)+"</value><next>"+H(e.slice(1),"")+"</next></block>"}}else{var s="";s=H(e[0].stmt.body,s),s='<block type="controls_repeat_ext"><value name="TIMES"><shadow type="math_number"><field name="NUM">'+function(e){return e.stmt.number.expression}(e[0])+'</field></shadow></value><statement name="DO">'+s,s+="</statement>",t=e.length>1?t+s+"<next>"+H(e.slice(1),"")+"</next></block>":t+s+"</block>"}}return t}function J(e){var t="<xml>",n=R(e);if(n instanceof I)console.error("Syntax Error: ".concat(n));else{t+=H(n.body,""),t+="</xml>";var a=_.a.Xml.textToDom(t);if(_.a.getMainWorkspace().clear(),_.a.Xml.domToWorkspace(a,b.mainWorkspace),""===e)return;"all"===n.body[0].meta.attributes.get("frozen")&&function(e){var t=_.a.getMainWorkspace().getTopBlocks(!0);z.a.forEach(t,(function(t){return Z(t,e)}))}(n.body[0].meta.attributes.has("freezeArgs"))}}function K(e,t,n){var a=G.get(n.type),i=n.getNested();if(a?e+=t+a(n)+"\n":G.has(n.type)||W.includes(n.type)||console.error("No KoboldConvert function found for ".concat(n.type)),i.length>0){var o,r=Object(g.a)(i);try{for(r.s();!(o=r.n()).done;){e=K(e,t+"\t",o.value)}}catch(s){r.e(s)}finally{r.f()}}return n.getNextBlock()&&a&&(e=K(e,t,n.getNextBlock())),e}function Q(){var e="",t=_.a.getMainWorkspace().getTopBlocks(!0);return z.a.forEach(t,(function(t){e+=K("","",t)+"\n"})),e}function Z(e,t){e.setMovable(!1),e.setDeletable(!1),e.setColour(function(e,t){var n=parseInt(e.slice(1),16),a=t<0?0:255,i=t<0?-1*t:t,o=n>>16,r=n>>8&255,s=255&n;return"#"+(16777216+65536*(Math.round((a-o)*i)+o)+256*(Math.round((a-r)*i)+r)+(Math.round((a-s)*i)+s)).toString(16).slice(1)}(e.getColour(),-.5)),t&&e.setEditable(!1),e.getNextBlock()&&Z(e.getNextBlock(),t)}function X(e,t){return t?'<shadow type="math_number" id="'+t+'"><field name="NUM">'+e+"</field></shadow>":'<shadow type="math_number"><field name="NUM">'+e+"</field></shadow>"}var Y={move2:{block:'<block type="Forward"><value name="VALUE">'+X(1)+'</value></block><block type="Left"></block><block type="Right"></block>'},place:{block:'<block type="PlaceCube"></block>'},remove:{block:'<block type="RemoveCube"></block>',teaser:'<block type="RemoveCube_teaser"></block>',pack:"remove"},up:{block:'<block type="Up"><value name="VALUE">'+X(1)+"</value></block>",teaser:'<block type="Up_teaser"><value name="VALUE">'+X(1)+"</value></block>",pack:"up"},down:{block:'<block type="Down"><value name="VALUE">'+X(1)+"</value></block>",teaser:'<block type="Down_teaser"><value name="VALUE">'+X(1)+"</value></block>",pack:"up"},repeat:{block:'<block type="controls_repeat_ext"><value name="TIMES">'+X(10)+"</value></block>",teaser:'<block type="controls_repeat_teaser"><value name="TIMES">'+X(10)+"</value></block>",pack:"repeat"},defproc:{block:'<block type="procedures_defnoreturn"></block>',pack:"procedures"}};var $,ee=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).workspace=void 0,_.a.FieldColour.COLOURS=["#1ca84f","#a870b7","#ff1a6d","#00bcf4","#ffc911","#ff6e3d","#000000","#ffffff"],_.a.Blocks.Up={init:function(){this.jsonInit({message0:"up by %1",args0:[{type:"input_value",name:"VALUE",check:"Number"}],previousStatement:!0,nextStatement:!0,inputsInline:!0,colour:B})}},G.set("Up",(function(e){var t,n,a;return"Up(".concat(null===(t=e.getInput("VALUE"))||void 0===t||null===(n=t.connection)||void 0===n||null===(a=n.targetBlock())||void 0===a?void 0:a.getFieldValue("NUM"),")")})),_.a.Blocks.Down={init:function(){this.jsonInit({message0:"down by %1",args0:[{type:"input_value",name:"VALUE",check:"Number"}],previousStatement:!0,nextStatement:!0,inputsInline:!0,colour:B})}},G.set("Down",(function(e){var t,n,a;return"Down(".concat(null===(t=e.getInput("VALUE"))||void 0===t||null===(n=t.connection)||void 0===n||null===(a=n.targetBlock())||void 0===a?void 0:a.getFieldValue("NUM"),")")})),_.a.Blocks.Forward={init:function(){this.jsonInit({message0:"forward by %1",args0:[{type:"input_value",name:"VALUE",check:"Number"}],previousStatement:!0,nextStatement:!0,inputsInline:!0,colour:V})}},G.set("Forward",(function(e){var t,n,a;return"Forward(".concat(null===(t=e.getInput("VALUE"))||void 0===t||null===(n=t.connection)||void 0===n||null===(a=n.targetBlock())||void 0===a?void 0:a.getFieldValue("NUM"),")")})),_.a.Blocks.Left={init:function(){this.setColour(V),this.appendDummyInput().appendField("turn left"),this.setPreviousStatement(!0),this.setNextStatement(!0)}},G.set("Left",(function(e){return"Left()"})),_.a.Blocks.Right={init:function(){this.setColour(V),this.appendDummyInput().appendField("turn right"),this.setPreviousStatement(!0),this.setNextStatement(!0)}},G.set("Right",(function(e){return"Right()"})),_.a.Blocks.PlaceCube={init:function(){this.setColour(q),this.appendDummyInput().appendField("place cube").appendField(new _.a.FieldColour(_.a.FieldColour.COLOURS[0]),"VALUE"),this.setPreviousStatement(!0),this.setNextStatement(!0)}},G.set("PlaceCube",(function(e){return"PlaceCube("+_.a.FieldColour.COLOURS.indexOf(e.getFieldValue("VALUE"))+")"})),_.a.Blocks.RemoveCube={init:function(){this.setColour(q),this.appendDummyInput().appendField("remove cube"),this.setPreviousStatement(!0),this.setNextStatement(!0)}},G.set("RemoveCube",(function(e){return"RemoveCube()"})),G.set("controls_repeat_ext",(function(e){var t,n,a;return"repeat ".concat(null===(t=e.getInput("TIMES"))||void 0===t||null===(n=t.connection)||void 0===n||null===(a=n.targetBlock())||void 0===a?void 0:a.getFieldValue("NUM")," times")})),G.set("procedures_defnoreturn",(function(e){var t=e.getProcedureDef(),n=Object(v.a)(t,2),a=n[0],i=n[1];return"define ".concat(a,"(").concat(i,")")})),G.set("procedures_callnoreturn",(function(e){return"".concat(e.getFieldValue("NAME"),"()")})),a}return Object(p.a)(n,[{key:"render",value:function(){return Object(L.jsx)("div",{id:"blocklyDiv",style:{width:"100%"}})}},{key:"componentDidMount",value:function(){console.log("mount"),this.workspace=_.a.inject("blocklyDiv",{toolbox:document.getElementById("toolbox"),renderer:"thrasos"}),this.updateToolbox(this.workspace,this.props.granted_blocks)}},{key:"componentDidUpdate",value:function(){console.log("update"),this.workspace&&this.updateToolbox(this.workspace,this.props.granted_blocks)}},{key:"updateToolbox",value:function(e,t){var n=this,a='<xml id="toolbox" style="display: none">';z.a.forEach(Y,(function(e,i){var o;!z.a.includes(null===(o=n.props.puzzle)||void 0===o?void 0:o.library.restricted,i)&&z.a.includes(t,i)&&(a+=e.block)})),a+="</xml>",e.updateToolbox(a)}}]),n}(s.a.Component),te=n(6),ne=n(24);!function(e){e.Number="number"}($||($={}));var ae,ie=function e(){Object(h.a)(this,e),this.values=void 0,this.procedures=void 0,this.values=new Map,this.procedures=new Map};!function(e){e[e.CustomError=0]="CustomError",e[e.UnknownIdentifier=1]="UnknownIdentifier",e[e.ArityMismatch=2]="ArityMismatch",e[e.ArgumentError=3]="ArgumentError",e[e.ValueError=4]="ValueError"}(ae||(ae={}));var oe,re=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e,a,i){var o;return Object(h.a)(this,n),(o=t.call(this,i)).code=void 0,o.location=void 0,Object.setPrototypeOf(Object(j.a)(o),n.prototype),o.code=e,o.location=a,o}return n}(Object(x.a)(Error));function se(e,t,n){return console.error(t),new re(e,n?n.location:new O,t)}function ce(e,t){switch(t.kind){case E.Number:return{kind:$.Number,val:t.expression};case E.Ident:var n=t.expression.name;return e.values.has(n)?z.a.clone(e.values.get(n)):se(ae.UnknownIdentifier,"Unknown identifier ".concat(n),t.meta)}}function le(e,t,n){var a=ce(e,t);if(a instanceof re)return a;var i,o=(i=a).kind===$.Number?i.val:se(ae.ValueError,"Could not convert ".concat(JSON.stringify(i)," to int"));return o instanceof re?o:o<0?se(ae.ArgumentError,"Repeat with negative number of iterations: ".concat(o),n):o}function ue(e,t){var n,a=[],i=Object(g.a)(t.args);try{for(i.s();!(n=i.n()).done;){var o=ce(e,n.value);if(o instanceof re)return o;a.push(o)}}catch(r){i.e(r)}finally{i.f()}return a}function de(e,t,n){return e.procedures.has(t.name)?z.a.clone(e.procedures.get(t.name)):se(ae.UnknownIdentifier,"Unknown procedure ".concat(t.name),n)}function he(e,t,n,a){var i=ue(e,n);if(i instanceof re)return i;var o=i.length;if(o!==t.params.length)return se(ae.ArityMismatch,"Procedure ".concat(n.name," expects ").concat(t.params.length," arguments, received ").concat(o));var r,s=z.a.cloneDeep(e),c=Object(g.a)(z.a.zip(t.params,i));try{for(c.s();!(r=c.n()).done;){var l=Object(v.a)(r.value,2),u=l[0],d=l[1];s.values.set(u,d)}}catch(h){c.e(h)}finally{c.f()}return s}function pe(e,t){var n=e.stmt;return{kind:A.Repeat,meta:e.meta,stmt:{number:{kind:E.Number,meta:n.number.meta,expression:t-1},body:n.body}}}!function(e){e.Running="running",e.Stopped="stopped",e.Paused="paused",e.Finished="finished"}(oe||(oe={}));var me=function(){function e(t,n){Object(h.a)(this,e),this.world=void 0,this.base_env=void 0,this.sim_state=void 0,this.execution_stack=void 0,this.TICKS_PER_SECOND=60,this.ticks_per_command=30,this.last_stmt_exec_time=0,this.total_steps=0,this.world=t,this.sim_state=oe.Stopped,this.execution_stack=[],this.base_env=z.a.cloneDeep(ve);var a,i=Object(g.a)(n.body.slice().reverse());try{for(i.s();!(a=i.n()).done;){var o=a.value;switch(o.kind){case"procedure":this.base_env.procedures.set(o.name,z.a.cloneDeep(o));break;default:this.execution_stack.push([o,this.base_env])}}}catch(r){i.e(r)}finally{i.f()}}return Object(p.a)(e,[{key:"is_running",value:function(){return this.sim_state===oe.Running}},{key:"set_running",value:function(){this.sim_state=oe.Running}},{key:"is_finished",value:function(){return this.sim_state===oe.Finished}},{key:"set_finished",value:function(){this.sim_state=oe.Finished}},{key:"is_stopped",value:function(){return this.sim_state===oe.Stopped}},{key:"set_stopped",value:function(){this.sim_state=oe.Stopped}},{key:"execute_to_command",value:function(){if(0!==this.execution_stack.length){if(this.is_running()){var e=this.execution_stack.pop(),t=Object(v.a)(e,2),n=t[0],a=t[1];switch(n.kind){case A.Repeat:var i=n.stmt,o=le(a,i.number,n.meta);if(o instanceof re)return o;o>1&&this.execution_stack.push([pe(n,o),a]);var r,s=Object(g.a)(i.body.slice().reverse());try{for(s.s();!(r=s.n()).done;){var c=r.value;this.execution_stack.push([c,a])}}catch(k){s.e(k)}finally{s.f()}return this.execute_to_command();case A.Execute:var l=n.stmt,u=de(a,l.invoke,n.meta);if(u instanceof re)return u;var d=he(a,u,l.invoke,n.meta);if(d instanceof re)return d;var h,p=Object(g.a)(u.body.slice().reverse());try{for(p.s();!(h=p.n()).done;){var m=h.value;this.execution_stack.push([m,d])}}catch(k){p.e(k)}finally{p.f()}return this.execute_to_command();case A.Command:var f=n.stmt,b=ue(a,f.invoke);if(b instanceof re)return b;var _=this.world.execute({name:f.invoke.name,args:b,meta:n.meta});if(_ instanceof re)return _}}}else this.set_finished()}}]),e}(),fe=function(){function e(t){Object(h.a)(this,e),this.world=void 0,this.world=t}return Object(p.a)(e,[{key:"execute_to_end",value:function(e,t){switch(t.kind){case A.Repeat:var n=t.stmt,a=le(e,n.number,t.meta);if(a instanceof re)return a;for(var i=0;i<a;i++){var o=this.execute_block_to_end(e,n.body);if(o instanceof re)return o}break;case A.Execute:var r=t.stmt,s=de(e,r.invoke,t.meta);if(s instanceof re)return s;var c=he(e,s,r.invoke,t.meta);if(c instanceof re)return c;var l=this.execute_block_to_end(c,s.body);if(l instanceof re)return l;break;case A.Command:var u=t.stmt,d=ue(e,u.invoke);if(d instanceof re)return d;var h=this.world.execute({name:u.invoke.name,args:d,meta:t.meta});if(h instanceof re)return h}}},{key:"execute_block_to_end",value:function(e,t){var n,a=Object(g.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=this.execute_to_end(e,i);if(o instanceof re)return o}}catch(r){a.e(r)}finally{a.f()}}},{key:"run_program_to_end",value:function(e,t){var n,a=z.a.cloneDeep(e),i=Object(g.a)(t.body);try{for(i.s();!(n=i.n()).done;){var o=n.value;switch(o.kind){case"procedure":a.procedures.set(o.name,z.a.cloneDeep(o));break;default:var r=this.execute_to_end(a,o);if(r instanceof re)return r}}}catch(s){i.e(s)}finally{i.f()}}}]),e}();var ve=null;function ge(){var e=R("\ndefine Forward(x)\n    repeat x times\n        command forward()\n\ndefine Left()\n    command left()\n\ndefine Right()\n    command right()\n\ndefine Up(x)\n    repeat x times\n        command up()\n\ndefine Down(x)\n    repeat x times\n        command down()\n\ndefine PlaceCube(color)\n    command cube(color)\n\ndefine RemoveCube()\n    command remove()\n");if(e instanceof I)console.error("Error parsing stdlib: ".concat(JSON.stringify(e)));else{var t=function(e){var t,n=new ie,a=Object(g.a)(e.body);try{for(a.s();!(t=a.n()).done;){var i=t.value;if("procedure"===i.kind){var o=i;n.procedures.set(o.name,z.a.cloneDeep(o))}}}catch(r){a.e(r)}finally{a.f()}return n}(e);t instanceof re?console.error("Error loading stdlib: ".concat(JSON.stringify(t))):ve=t}}function be(e,t){var n,a=Object(g.a)(e);try{for(a.s();!(n=a.n()).done;){var i=Object(v.a)(n.value,2),o=i[0];i[1];if(o.equals(t))return!0}}catch(r){a.e(r)}finally{a.f()}return!1}var _e=n(35),ke=new te.r(0,0,1),ze=new te.r(0,0,-1);var je,xe,ye=function(){function e(){Object(h.a)(this,e),this.dragon_pos=void 0,this.dragon_dir=void 0,this.cube_map=void 0,this.dirty=!1,this.dragon_pos=new te.r(0,0,0),this.dragon_dir=new te.r(1,0,0),this.cube_map=new Map}return Object(p.a)(e,[{key:"mark_dirty",value:function(){this.dirty=!0}},{key:"mark_clean",value:function(){this.dirty=!1}},{key:"execute",value:function(e){switch(e.name){case"forward":this.dragon_pos.add(this.dragon_dir);break;case"up":this.dragon_pos.add(ke);break;case"down":if(0===this.dragon_pos.z)return;this.dragon_pos.add(ze);break;case"left":this.dragon_dir=new te.r(-this.dragon_dir.y,this.dragon_dir.x,this.dragon_dir.z);break;case"right":this.dragon_dir=new te.r(this.dragon_dir.y,-this.dragon_dir.x,this.dragon_dir.z);break;case"cube":var t=function(e){return e.args.length>1?se(ae.CustomError,"Expected 1 argument to ".concat(e.name),e.meta):e.args[0]&&e.args[0].kind===$.Number?e.args[0].val:se(ae.CustomError,"Expected an integer argument to ".concat(e.name),e.meta)}(e);if(t instanceof re)return t;if(be(this.cube_map,this.dragon_pos))return;this.cube_map.set(this.dragon_pos.clone(),t);break;case"remove":if(!function(e,t){var n,a=Object(g.a)(e);try{for(a.s();!(n=a.n()).done;){var i=Object(v.a)(n.value,2),o=i[0];if(i[1],o.equals(t))return e.delete(o),!0}}catch(r){a.e(r)}finally{a.f()}return!1}(this.cube_map,this.dragon_pos))return;break;default:return se(ae.CustomError,"Unknown command ".concat(e.name),e.meta)}this.mark_dirty()}},{key:"toJSON",value:function(){var e=this.cube_map,t=Object(_e.a)(this,["cube_map"]);return Object(u.a)({cube_map:JSON.stringify(Object(d.a)(e))},t)}}],[{key:"fromJSON",value:function(t){var n=JSON.parse(t),a=new e;return a.dragon_pos=n.dragon_pos,a.dragon_dir=n.dragon_dir,a.dirty=n.dirty,a.cube_map=new Map(JSON.parse(n.cube_map)),a}}]),e}(),we=new Map([["forward","media/DA2-forward.png"],["set","media/blockSvgs/set.svg"],["left","media/blockSvgs/left.svg"],["right","media/DA2-right.png"],["placecube","media/DA2-place-cube.png"],["removecube","media/DA2-remove-cube.png"],["variable","media/variable.png"],["rotate","media/DA2-rotate.png"],["scroll","media/DA2-tilt.png"],["square","media/DA2-cube.png"],["x","media/x.png"],["forwardx","media/forwardx.png"],["get","media/get.png"],["up","media/DA2-up.png"],["down","media/DA2-down.png"],["repeat","media/DA2-repeat.png"],["repeat4","media/blockSvgs/repeat4.svg"],["repeat5","media/blockSvgs/repeat5.svg"],["repeat9","media/blockSvgs/repeat9.svg"],["SquareProc","media/blockSvgs/SquareProc.svg"],["upcube","media/upcube.png"],["FixedCastleProc","media/blockSvgs/FixedCastleProc.svg"],["FixedTowerProc","media/blockSvgs/FixedTowerProc.svg"],["FixedWallProc","media/blockSvgs/FixedWallProc.svg"],["run","media/DA2-run-button.png"],["rotateCW","media/rotateCWButton.png"],["rotateCCW","media/rotateCCWButton.png"],["camera","media/DA2-camera-controls.png"],["learn","media/learnButton.png"],["workshop","media/workshopButton.png"],["clear","media/clearSandboxButton.png"],["speedSlider","media/DA2-speed-slider.png"],["done","media/doneButton.png"],["pinkboxGround","media/DA2-dragon-pos-cube.png"],["pinkboxUp","media/pinkboxUp.png"],["castle","media/blockSvgs/castle.svg"],["wall","media/blockSvgs/wall.svg"],["tower","media/blockSvgs/tower.svg"],["towerlayer","media/blockSvgs/towerlayer.svg"],["towertop","media/blockSvgs/towertop.svg"],["wallsheet","media/blockSvgs/wallsheet.svg"],["walltop","media/blockSvgs/walltop.svg"],["pillarProc","media/blockSvgs/pillarProc.svg"],["procDef","media/blockSvgs/procDef.svg"],["procedure","media/DA2-procedure.png"],["bridge","media/DA2-bridge.png"],["cube","media/Da2-cube.png"],["purple_cube","media/purple_cube.png"],["menu_btn","media/menu_btn.png"]]);function Oe(e){var t=new ye;if(t.dragon_pos=Object(ne.a)(te.r,Object(d.a)(e.pos)),t.dragon_dir=Object(ne.a)(te.r,Object(d.a)(e.dir)),e.cubes){var n,a=Object(g.a)(e.cubes);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.pos,r=i.color;t.cube_map.set(Object(ne.a)(te.r,Object(d.a)(o)),r)}}catch(s){a.e(s)}finally{a.f()}}return t.dirty=!0,t}!function(e){e.DragonPos="position",e.AddCube="addcube",e.RemoveCube="removecube",e.RunOnly="runonly",e.MinCube="mincube"}(je||(je={})),function(e){e.Solution="solution",e.RunOnly="run_only",e.MinCube="min_cube"}(xe||(xe={}));var Se,Ce=function(){function e(){Object(h.a)(this,e),this.start_code="",this.start_world=new ye,this.goals=[],this.instructions="",this.library={restricted:[],required:[],granted:[]},this.name="",this.tag="",this.win_callback=function(){}}return Object(p.a)(e,[{key:"check_completed",value:function(e){this.is_complete(e)&&this.win_callback()}},{key:"is_complete",value:function(e){if(!e.simulator.is_finished()||0==this.goals.length)return!1;var t,n,a=Object(g.a)(this.goals);try{for(a.s();!(n=a.n()).done;){var i=n.value;switch(i.kind){case je.RunOnly:return!0;case je.MinCube:var o=i.value;return e.world.cube_map.size>=o;case je.AddCube:if(t=i.position,!be(e.world.cube_map,t))return!1;break;case je.RemoveCube:if(t=i.position,be(e.world.cube_map,t))return!1;break;case je.DragonPos:var r=i.position;return e.world.dragon_pos.equals(r)}}}catch(s){a.e(s)}finally{a.f()}return e.world.cube_map.size<=this.goals.length}}],[{key:"make_from_file",value:function(t,n){var a=new e;a.win_callback=n;var i=function(e){return new Promise((function(n,i){e.program?fetch(e.program).then((function(e){return e.text()})).then((function(t){a.start_code=t,n(e)})).catch((function(n){i("Encountered error loading program from ".concat(e.program,", as specified in ").concat(t,": ").concat(n))})):n(e)}))},o=function(e){return new Promise((function(n,i){e.goal===xe.Solution?e.solution?fetch(e.solution).then((function(e){return e.text()})).then((function(o){var r=R(o);if(r instanceof I)i("Syntax error when parsing solution ".concat(o," from ").concat(t,": ").concat(r));else{var s=Oe(e.world);!function(e,t){if(!ve)return console.error("run called before stdlib is loaded"),se(ae.CustomError,"run called before stdlib is loaded");var n=new fe(e).run_program_to_end(ve,t);n instanceof re&&console.error("[RuntimeError] ".concat(n))}(s,r),a.goals=function(e,t){var n,a=[],i=Object(g.a)(e.cube_map);try{for(i.s();!(n=i.n()).done;){var o=n.value;be(t.cube_map,o[0])||a.push({kind:je.AddCube,position:o[0]})}}catch(l){i.e(l)}finally{i.f()}var r,s=Object(g.a)(t.cube_map);try{for(s.s();!(r=s.n()).done;){var c=r.value;be(e.cube_map,c[0])||a.push({kind:je.RemoveCube,position:c[0]})}}catch(l){s.e(l)}finally{s.f()}return 0===a.length&&(e.dragon_pos.equals(t.dragon_pos)||a.push({kind:je.DragonPos,position:e.dragon_pos})),a}(s,a.start_world),n(e)}})).catch((function(n){i("Encountered error loading solution from ".concat(e.solution,", as specified in ").concat(t,": ").concat(n))})):i("Puzzle specification ".concat(t," has goal type ").concat(e.goal,", but does not provide solution file")):e.goal===xe.MinCube?(a.goals=[{kind:je.MinCube,value:e.goalValue}],n(e)):e.goal===xe.RunOnly?(a.goals=[{kind:je.RunOnly}],n(e)):i("Unrecognized goal type ".concat(e.goal," in ").concat(t))}))};return new Promise((function(e){fetch(t).then((function(e){return e.json()})).then((function(e){return a.start_world=Oe(e.world),a.library=e.library,a.name=e.name,a.tag=e.tag,a.instructions="Goal: "+e.instructions.replace(/{(\w+)}/g,(function(e,t){return"png"===we.get(t).substring(we.get(t).length-3)?we.has(t)?'<object class="instructions-png" data="'.concat(we.get(t),'"></object>'):e:we.has(t)?'<object class="instructions-svg" data="'.concat(we.get(t),'"></object>'):e})),e})).then(i).then(o).then((function(){e(a)})).catch((function(e){return console.error(e)}))}))}}]),e}(),Me=new Ce,Ne=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(L.jsx)("div",{className:"slider-container",children:Object(L.jsxs)("div",{className:"slider-buttons-container",children:[Object(L.jsx)("div",{className:"slider-left-header",children:Object(L.jsx)("h6",{children:"Fast"})}),Object(L.jsx)("input",{type:"range",min:.01,max:2,step:.01,className:"slider",onChange:this.props.onChange}),Object(L.jsx)("div",{className:"slider-right-header",children:Object(L.jsx)("h6",{children:"Slow"})})]})})}}]),n}(s.a.Component),Pe=n(20);function Ee(e){return Object(L.jsx)("div",{children:Object(L.jsx)("button",{className:"ZoomIn",onClick:e.onClickFunction,children:Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"search-plus"})})})})}function Ae(e){return Object(L.jsx)("div",{children:Object(L.jsxs)("button",{className:"ZoomOut",onClick:e.onClickFunction,children:[" ",Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"search-minus"})})]})})}function Ie(e){return Object(L.jsx)("div",{children:Object(L.jsx)("button",{className:"TiltUp",onClick:e.onClickFunction,children:Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"arrow-up"})})})})}function De(e){return Object(L.jsx)("div",{children:Object(L.jsx)("button",{className:"TiltDown",onClick:e.onClickFunction,children:Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"arrow-down"})})})})}function Te(e){return Object(L.jsx)("div",{children:Object(L.jsx)("button",{className:"RotateRight",onClick:e.onClickFunction,children:Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"redo"})})})})}function Ue(e){return Object(L.jsx)("div",{children:Object(L.jsx)("button",{className:"RotateLeft",onClick:e.onClickFunction,children:Object(L.jsx)("h1",{children:Object(L.jsx)(Pe.a,{icon:"undo"})})})})}!function(e){e.waiting="waiting",e.animating="animating",e.done="done",e.null="null"}(Se||(Se={}));var Re=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var a;Object(h.a)(this,n),(a=t.call(this,e)).divRef=void 0,a.constantValues=void 0,a.storageMaps=void 0,a.mainStuff=void 0,a.cameraPos=void 0,a.clockStuff=void 0,a.geometries=void 0,a.dragAnimation=void 0,a.finalValues=void 0,a.cubeOptMaps=void 0,a.goalOptMaps=void 0,a.puzzleInit=void 0,a.handleSlideChange=function(e){a.dragAnimation.animPerSec=parseFloat(e.target.value)},a.zoomInCamera=function(e){a.cameraPos.relativeCamPosMag>5&&(a.cameraPos.relativeCamPos.multiplyScalar(.8),a.cameraPos.relativeCamPosMag=a.cameraPos.relativeCamPos.length()-.5)},a.zoomOutCamera=function(e){a.cameraPos.relativeCamPosMag<100&&(a.cameraPos.relativeCamPos.multiplyScalar(1.2),a.cameraPos.relativeCamPosMag=a.cameraPos.relativeCamPos.length()-.5)},a.rotateCameraRight=function(e){var t=new te.m;t.setFromAxisAngle(a.cameraPos.upVector,a.degreesToRadians(10)),a.cameraPos.relativeCamPos.applyQuaternion(t)},a.rotateCameraLeft=function(e){var t=new te.m;t.setFromAxisAngle(a.cameraPos.upVector,a.degreesToRadians(-10)),a.cameraPos.relativeCamPos.applyQuaternion(t)},a.tiltCameraUp=function(e){var t=new te.m;t.setFromAxisAngle(a.cameraPos.relativeCamPos.clone().cross(a.cameraPos.upVector).normalize(),a.degreesToRadians(10)),a.cameraPos.relativeCamPos.applyQuaternion(t)},a.tiltCameraDown=function(e){var t=new te.m;t.setFromAxisAngle(a.cameraPos.relativeCamPos.clone().cross(a.cameraPos.upVector).normalize(),a.degreesToRadians(-10)),a.cameraPos.relativeCamPos.applyQuaternion(t)},a.constantValues={WOBBLE_PERIOD:4,WOBBLE_MAGNITUDE:.05,TRANSLATION_SMOOTHNESS:1.5,ROTATION_SMOOTHNESS:5,MAX_ANIMATION_TIME:.4,MIN_ANIMATION_TIME:.1,loader:new te.q},a.storageMaps={cubeColors:_.a.FieldColour.COLOURS,cubes:new Map,goalCubes:new Map,cubeMats:new Map},a.cameraPos={relativeCamPos:new te.r(-15,0,12),dragonOffset:new te.r(.5,.5,1.5),cubeOffset:new te.r(.5,.5,.5),relativeCamPosMag:0,upVector:new te.r(0,0,1)},a.mainStuff={scene:new te.o,camera:new te.k(60,window.innerWidth/window.innerHeight,.1,1500),oldCamQ:new te.m,renderer:new te.s({antialias:!0})},a.mainStuff.renderer.setSize(window.innerWidth/2,window.innerHeight/2),a.mainStuff.camera.position.copy(a.cameraPos.relativeCamPos),a.mainStuff.camera.lookAt(new te.r(0,0,0)),a.mainStuff.camera.up.set(0,0,1),a.mainStuff.camera.aspect=window.innerWidth/window.innerHeight,a.mainStuff.camera.updateProjectionMatrix(),a.clockStuff={clock:new te.d,time:0},a.finalValues={finalDragPos:new te.r,finalDragQ:new te.m},a.geometries={cubeGeo:new te.c(1,1,1),goalGeo:new te.c(1.1,1.1,1.1),cubeGoalMat:new te.j({color:"#4078E6",transparent:!0,opacity:.5}),dragonGoalMat:new te.j({color:"#df67be",transparent:!0,opacity:.5}),goalShadow:new te.h(new te.l(1,1,32),new te.i({color:"#686868",transparent:!0,opacity:.31,side:te.g})),light:new te.f("#ffffff",1.74),planeGeometry:new te.l(100,100,32),planeMaterial:new te.i,plane:new te.h,dragonGeometry:new te.p(.5,32,32),dragon:new te.h(new te.p(.5,32,32),new te.j({color:"#f56e90"})),dragonNose:new te.b(new te.r(1,0,0),new te.r(0,0,0),1,"#ff0000",.5,.2),geometry:new te.l(1,1,32),zCuePlane:new te.h(new te.l(1,1,32),new te.i({color:"#686868",transparent:!0,opacity:.8,side:te.g}))},a.geometries.dragon.position.copy(a.props.world.dragon_pos).add(a.cameraPos.dragonOffset),a.dragAnimation={animStatus:Se.null,waitTime:0,animTime:0,animPerSec:.4},a.cubeOptMaps={available:new Map,filled:new Map},a.goalOptMaps={available:new Map,filled:new Map};var i=a.constantValues.loader.load("media/canvas_cube.png");a.storageMaps.cubeColors.forEach((function(e){a.storageMaps.cubeMats.set(e,new te.j({color:e,map:i})),a.storageMaps.cubes.set(e,[])})),a.storageMaps.goalCubes.set("#".concat(a.geometries.cubeGoalMat.color.getHexString()),[]),a.storageMaps.goalCubes.set("#".concat(a.geometries.dragonGoalMat.color.getHexString()),[]),a.puzzleInit="",a.cameraPos.relativeCamPosMag=a.cameraPos.relativeCamPos.length()-.5,a.geometries.light.position.set(-.56,-.32,.77),a.mainStuff.scene.add(a.geometries.light),a.mainStuff.scene.add(new te.a("#404040"));var o=a.constantValues.loader.load("media/grass_texture.png");o.wrapS=te.n,o.wrapT=te.n,o.repeat.set(100,100),a.geometries.planeMaterial.setValues({map:o,side:te.g}),a.geometries.plane=new te.h(a.geometries.planeGeometry,a.geometries.planeMaterial),a.mainStuff.scene.add(a.geometries.plane),a.geometries.dragon.add(a.geometries.dragonNose),a.mainStuff.scene.add(a.geometries.dragon),a.mainStuff.scene.add(a.geometries.zCuePlane);var r="media/skybox/",c=".jpg",l=[r+"px"+c,r+"nx"+c,r+"py"+c,r+"ny"+c,r+"pz"+c,r+"nz"+c],u=new te.e;return a.mainStuff.scene.background=u.load(l),a.storageMaps.cubeColors.forEach((function(e){a.cubeOptMaps.available.set(e,[])})),a.divRef=s.a.createRef(),a}return Object(p.a)(n,[{key:"positionZCue",value:function(){for(var e=this.geometries.dragon.position.z,t=new te.r,n=Math.floor(this.geometries.dragon.position.z);n>=0;n--)if(be(this.props.world.cube_map,t.set(Math.floor(this.geometries.dragon.position.x),Math.floor(this.geometries.dragon.position.y),n)))return e-=n+(this.cameraPos.dragonOffset.z-this.cameraPos.cubeOffset.z),this.geometries.zCuePlane.position.copy(this.geometries.dragon.position),void this.geometries.zCuePlane.translateZ(.1-e);this.geometries.zCuePlane.position.copy(this.geometries.dragon.position),this.geometries.zCuePlane.translateZ(.1-e)}},{key:"degreesToRadians",value:function(e){return e/180*Math.PI}},{key:"removeCube",value:function(e,t){be(this.props.world.cube_map,e.position)?this.cubeOptMaps.filled.set(e.position,e):(this.mainStuff.scene.remove(e),void 0!==e&&(this.cubeOptMaps.available.get(t).includes(e)||this.cubeOptMaps.available.get(t).push(e)),this.cubeOptMaps.filled.delete(e.position))}},{key:"addCube",value:function(e,t){if(!be(this.cubeOptMaps.filled,e)){var n,a=null===(n=this.cubeOptMaps.available.get("#".concat(t.color.getHexString())))||void 0===n?void 0:n.pop();if(a)a.position.copy(e).add(this.cameraPos.cubeOffset),this.mainStuff.scene.add(a),this.cubeOptMaps.filled.set(a.position,a);else{var i=new te.h(this.geometries.cubeGeo,t);i.position.copy(e).add(this.cameraPos.cubeOffset),this.storageMaps.cubes.get("#".concat(t.color.getHexString())).push(i),this.cubeOptMaps.filled.set(i.position,i),this.mainStuff.scene.add(i)}}}},{key:"removePuzzleCube",value:function(e){if(!be(this.props.world.cube_map,e.position)){var t;this.mainStuff.scene.remove(e);var n=null===(t=this.storageMaps.goalCubes.get(this.geometries.cubeGoalMat.color.getHexString()))||void 0===t?void 0:t.indexOf(e);n&&this.storageMaps.goalCubes.get(this.geometries.cubeGoalMat.color.getHexString()).splice(n,1)}}},{key:"removeDragonCube",value:function(e){if(!be(this.props.world.cube_map,e.position)){var t;this.mainStuff.scene.remove(e);var n=null===(t=this.storageMaps.goalCubes.get(this.geometries.dragonGoalMat.color.getHexString()))||void 0===t?void 0:t.indexOf(e);n&&this.storageMaps.goalCubes.get(this.geometries.dragonGoalMat.color.getHexString()).splice(n,1)}}},{key:"addPuzzleCube",value:function(e){var t,n=new te.h(this.geometries.cubeGeo,this.geometries.cubeGoalMat);n.position.copy(e).add(this.cameraPos.cubeOffset),null===(t=this.storageMaps.goalCubes.get("#".concat(this.geometries.cubeGoalMat.color.getHexString())))||void 0===t||t.push(n),this.mainStuff.scene.add(n)}},{key:"addDragonCube",value:function(e){var t,n=new te.h(this.geometries.cubeGeo,this.geometries.dragonGoalMat);n.position.copy(e).add(this.cameraPos.dragonOffset),null===(t=this.storageMaps.goalCubes.get("#".concat(this.geometries.dragonGoalMat.color.getHexString())))||void 0===t||t.push(n),this.mainStuff.scene.add(n)}},{key:"simulate",value:function(e){var t;this.props.simulator.is_running()&&(this.clockStuff.time+=e,this.clockStuff.time>this.dragAnimation.animPerSec&&(this.props.simulator.execute_to_command(),this.clockStuff.time=0,this.props.simulator.is_finished()&&(null===(t=this.props.puzzle)||void 0===t||t.check_completed(this.props))))}},{key:"updateDisplay",value:function(){var e=this;this.finalValues.finalDragPos.copy(this.props.world.dragon_pos).add(this.cameraPos.dragonOffset),this.finalValues.finalDragQ.setFromUnitVectors(new te.r(1,0,0),this.props.world.dragon_dir),-1===this.props.world.dragon_dir.x&&this.finalValues.finalDragQ.set(0,0,1,0),this.dragAnimation.waitTime=.1*this.dragAnimation.animPerSec,this.dragAnimation.animTime=Math.min(.9*this.dragAnimation.animPerSec,this.constantValues.MAX_ANIMATION_TIME),this.dragAnimation.animStatus=Se.waiting,this.dragAnimation.animTime<this.constantValues.MIN_ANIMATION_TIME&&(this.dragAnimation.animStatus=Se.animating),this.props.puzzle&&this.puzzleInit!==this.props.puzzle.name&&(this.storageMaps.goalCubes.get("#".concat(this.geometries.dragonGoalMat.color.getHexString()))&&this.storageMaps.goalCubes.get("#".concat(this.geometries.dragonGoalMat.color.getHexString())).forEach((function(t){e.removeDragonCube(t)})),this.storageMaps.goalCubes.get("#".concat(this.geometries.cubeGoalMat.color.getHexString()))&&this.storageMaps.goalCubes.get("#".concat(this.geometries.cubeGoalMat.color.getHexString())).forEach((function(t){e.removePuzzleCube(t)})),this.storageMaps.cubeColors.forEach((function(t){e.storageMaps.cubes.get(t)&&e.storageMaps.cubes.get(t).forEach((function(n){e.removeCube(n,t)}))})),this.props.puzzle.goals.forEach((function(t){t.kind===je.AddCube&&t.position&&e.addPuzzleCube(t.position),t.kind===je.DragonPos&&t.position&&e.addDragonCube(t.position)})),this.puzzleInit=this.props.puzzle.name),this.storageMaps.cubeColors.forEach((function(t){e.storageMaps.cubes.get(t).forEach((function(n){e.removeCube(n,t)}))}));var t,n=Object(g.a)(this.props.world.cube_map);try{for(n.s();!(t=n.n()).done;){var a=Object(v.a)(t.value,2),i=a[0],o=a[1],r=this.storageMaps.cubeColors[o];this.addCube(i,this.storageMaps.cubeMats.get(r))}}catch(s){n.e(s)}finally{n.f()}this.props.world.mark_clean()}},{key:"componentDidMount",value:function(){var e,t=this;null===(e=this.divRef.current)||void 0===e||e.appendChild(this.mainStuff.renderer.domElement);!function e(){requestAnimationFrame(e);var n=t.clockStuff.clock.getDelta();t.simulate(n),t.props.world.dirty&&t.updateDisplay(),t.positionZCue();var a=t.constantValues.WOBBLE_MAGNITUDE*Math.sin(4*t.clockStuff.clock.elapsedTime*Math.PI/t.constantValues.WOBBLE_PERIOD),i=t.constantValues.WOBBLE_MAGNITUDE*Math.cos(2*t.clockStuff.clock.elapsedTime*Math.PI/t.constantValues.WOBBLE_PERIOD),o=new te.r(0,i,a);t.dragAnimation.animStatus===Se.waiting&&(t.dragAnimation.waitTime-=n,t.dragAnimation.waitTime<=0&&(n+=t.dragAnimation.waitTime,t.dragAnimation.animStatus=Se.animating)),t.dragAnimation.animStatus===Se.animating&&(t.geometries.dragon.position.lerp(t.finalValues.finalDragPos,Math.min(n/t.dragAnimation.animTime,1)),t.geometries.dragon.quaternion.slerp(t.finalValues.finalDragQ,Math.min(n/t.dragAnimation.animTime,1)),t.dragAnimation.animTime-=n,t.dragAnimation.animTime<=0&&(t.geometries.dragon.position.copy(t.finalValues.finalDragPos),t.geometries.dragon.quaternion.copy(t.finalValues.finalDragQ),t.dragAnimation.animStatus=Se.done));var r=o.add(t.cameraPos.relativeCamPos).add(t.geometries.dragon.position);t.mainStuff.camera.position.lerp(r,t.constantValues.TRANSLATION_SMOOTHNESS*n),t.mainStuff.camera.lookAt(t.geometries.dragon.position);var s=t.mainStuff.camera.quaternion.clone(),c=t.mainStuff.camera.quaternion.clone();t.mainStuff.camera.quaternion.copy(c),t.mainStuff.camera.quaternion.slerp(s,t.constantValues.ROTATION_SMOOTHNESS*n),t.mainStuff.renderer.render(t.mainStuff.scene,t.mainStuff.camera)}()}},{key:"render",value:function(){return Object(L.jsx)("div",{id:"three-js",ref:this.divRef,children:Object(L.jsxs)("div",{className:"game-controls-bar-container",children:[Object(L.jsxs)("div",{className:"camera-control-category",children:[Object(L.jsx)("div",{className:"game-control_title",children:Object(L.jsx)("h4",{children:"Tilt"})}),Object(L.jsxs)("div",{className:"game-control_buttons",children:[Object(L.jsx)(De,{onClickFunction:this.tiltCameraDown}),Object(L.jsx)(Ie,{onClickFunction:this.tiltCameraUp})]})]}),Object(L.jsxs)("div",{className:"camera-control-category",children:[Object(L.jsx)("div",{className:"game-control_title",children:Object(L.jsx)("h4",{children:"Rotate"})}),Object(L.jsxs)("div",{className:"game-control_buttons",children:[Object(L.jsx)(Ue,{onClickFunction:this.rotateCameraLeft}),Object(L.jsx)(Te,{onClickFunction:this.rotateCameraRight})]})]}),Object(L.jsxs)("div",{className:"camera-control-category",children:[Object(L.jsx)("div",{className:"game-control_title",children:Object(L.jsx)("h4",{children:"Zoom"})}),Object(L.jsxs)("div",{className:"game-control_buttons",children:[Object(L.jsx)(Ee,{onClickFunction:this.zoomInCamera}),Object(L.jsx)(Ae,{onClickFunction:this.zoomOutCamera})]})]}),Object(L.jsxs)("div",{className:"camera-control-category",children:[Object(L.jsx)("div",{className:"game-control_title",children:Object(L.jsx)("h4",{children:"Change Speed"})}),Object(L.jsx)("div",{className:"btn-time-slider",children:Object(L.jsx)(Ne,{onChange:this.handleSlideChange})})]})]})})}}]),n}(s.a.Component);function Fe(e){var t=e.gamestate.reset?"Reset":"Run",n=e.gamestate.reset?"reset":"run";return Object(L.jsx)("button",{id:"game-control-btn-playback",className:"run-button-back",onClick:e.onClick,value:n,children:Object(L.jsx)("span",{className:"run-button-front",title:n,children:t})})}function Le(e){return e.gamestate.puzzle===Me?Object(L.jsx)("p",{children:"Welcome to Sandbox mode! Create anything you like!"}):e.gamestate.puzzle?Object(L.jsx)("p",{dangerouslySetInnerHTML:{__html:null===(t=e.gamestate.puzzle)||void 0===t?void 0:t.instructions}}):Object(L.jsx)("p",{});var t}var Ve=function(){function e(){Object(h.a)(this,e),this.packs=void 0,this.current_puzzle=void 0,this.completed_puzzle=void 0,this.packs=[],this.current_puzzle={pack_index:0,seq_index:0,puz_index:0},this.completed_puzzle=new Map}return Object(p.a)(e,[{key:"check_complete_pack",value:function(){var e,t=this.get_current_seq().puzzles,n=this.get_current_pack().name,a=Object(g.a)(t);try{for(a.s();!(e=a.n()).done;){var i=e.value,o=this.completed_puzzle.get(n);if(!o)return!1;if(!o.includes(i))return!1}}catch(r){a.e(r)}finally{a.f()}return!0}},{key:"complete_puzzle",value:function(){var e=this.get_current_pack().name,t=this.completed_puzzle.get(e);if(void 0===t)this.completed_puzzle.set(e,[this.get_current_puzzle()]);else{var n=this.get_current_puzzle();t.push(n),this.completed_puzzle.set(e,t)}}},{key:"find_completed_puzzle",value:function(){var e,t=new Array,n=Object(g.a)(this.completed_puzzle.keys());try{for(n.s();!(e=n.n()).done;){var a=e.value,i=this.completed_puzzle.get(a);if(i){var o,r=Object(g.a)(i);try{for(r.s();!(o=r.n()).done;){var s=o.value;t.push(s.name)}}catch(c){r.e(c)}finally{r.f()}}}}catch(c){n.e(c)}finally{n.f()}return t}},{key:"set_completed_puzzle",value:function(e){this.completed_puzzle=e}},{key:"set_pack",value:function(e){e!==this.current_puzzle.pack_index&&(this.current_puzzle={pack_index:e,seq_index:0,puz_index:0})}},{key:"set_puzzle",value:function(e){var t=this,n=!1;if(this.get_current_pack().seqs.forEach((function(a,i){a.puzzles.forEach((function(a,o){a.tag===e&&(t.current_puzzle={pack_index:t.current_puzzle.pack_index,seq_index:i,puz_index:o},n=!0)}))})),!n)throw new Error("No puzzle with tag=".concat(e," exists within the current pack ").concat(this.get_current_pack().name))}},{key:"get_all_puzzles",value:function(){var e,t=[],n=Object(g.a)(this.get_current_pack().seqs);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push.apply(t,Object(d.a)(a.puzzles.map((function(e){return e.tag}))))}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"get_current_puzzle",value:function(){return this.get_current_seq().puzzles[this.current_puzzle.puz_index]}},{key:"get_current_seq",value:function(){return this.get_current_pack().seqs[this.current_puzzle.seq_index]}},{key:"get_current_pack",value:function(){return this.packs[this.current_puzzle.pack_index]}},{key:"next_puzzle",value:function(){if(this.current_puzzle.puz_index=this.current_puzzle.puz_index+1,this.current_puzzle.puz_index!==this.get_current_seq().puzzles.length||(this.current_puzzle.puz_index=0,this.current_puzzle.seq_index++,this.current_puzzle.seq_index!==this.get_current_pack().seqs.length))return this.get_current_seq().puzzles[this.current_puzzle.puz_index]}},{key:"get_granted_blocks",value:function(e){console.log("called ggb");var t=[];if(e){var n,a=Object(g.a)(this.packs);try{for(a.s();!(n=a.n()).done;){var i,o=n.value,r=Object(g.a)(o.seqs);try{for(r.s();!(i=r.n()).done;){var s,c=i.value,l=Object(g.a)(c.puzzles);try{for(l.s();!(s=l.n()).done;){var u,d=s.value.library.granted,h=Object(g.a)(d);try{for(h.s();!(u=h.n()).done;){var p=u.value;t.includes(p)||t.push(p)}}catch(C){h.e(C)}finally{h.f()}}}catch(C){l.e(C)}finally{l.f()}}}catch(C){r.e(C)}finally{r.f()}}}catch(C){a.e(C)}finally{a.f()}}else{var m,f=Object(g.a)(this.completed_puzzle.keys());try{for(f.s();!(m=f.n()).done;){var v=m.value,b=this.completed_puzzle.get(v);if(b){var _,k=Object(g.a)(b);try{for(k.s();!(_=k.n()).done;){var z,j=_.value.library.granted,x=Object(g.a)(j);try{for(x.s();!(z=x.n()).done;){var y=z.value;t.includes(y)||t.push(y)}}catch(C){x.e(C)}finally{x.f()}}}catch(C){k.e(C)}finally{k.f()}}}}catch(C){f.e(C)}finally{f.f()}}if(this.get_current_puzzle()){var w,O=Object(g.a)(this.get_current_puzzle().library.required.concat(this.get_current_puzzle().library.granted));try{for(O.s();!(w=O.n()).done;){var S=w.value;t.includes(S)||t.push(S)}}catch(C){O.e(C)}finally{O.f()}}return console.log("granted blocks: "+t),t}},{key:"load_packs",value:function(e){return new Promise((function(t){var n,a=[],i=Object(g.a)(e.packs);try{var o=function(){var e=n.value;a.push(fetch("packs/".concat(e)).then((function(e){return e.json()})).catch((function(t){console.error("Problem encountered loading packs/".concat(e,": ").concat(t))})))};for(i.s();!(n=i.n()).done;)o()}catch(r){i.e(r)}finally{i.f()}t(a)}))}},{key:"load_all_puzzles",value:function(){var e,t=[],n=Object(g.a)(this.packs);try{for(n.s();!(e=n.n()).done;){var a,i=e.value,o=Object(g.a)(i.seqs);try{var r=function(){var e=a.value;e.puzzles.forEach((function(n,a){t.push(fetch("puzzles/".concat(n,".json")).then((function(e){return e.json()})).then((function(t){return e.puzzles[a]=t})).catch((function(e){return console.error("Could not load spec from puzzles/".concat(n,".json: ").concat(e))})))}))};for(o.s();!(a=o.n()).done;)r()}catch(s){o.e(s)}finally{o.f()}}}catch(s){n.e(s)}finally{n.f()}return Promise.all(t)}},{key:"initialize",value:function(){var e=this;return fetch("packs/packs.json").then((function(e){return e.json()})).then(this.load_packs).then((function(e){return Promise.all(e)})).then((function(t){return e.packs=t})).then((function(){return e.load_all_puzzles()})).catch((function(e){return console.error("Problem encountered loading packs/packs.json: ".concat(e))}))}}]),e}(),Be=n(18),qe=n(34),We=n(21);Be.b.add(qe.a,We.d,We.e,We.c,We.f,We.b,We.a);var Ge,He=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"returnHome",value:function(e){this.props.gameState.puzzle!==Me?this.props.onClickHome("puzzles/".concat(this.props.current_puzzle.tag,".json")):(console.log("loading last sandbox"),this.props.loadLastSandbox())}},{key:"openPuzzle",value:function(e){this.props.onClickToPuzzle("puzzles/".concat(e.currentTarget.id,".json"))}},{key:"render",value:function(){var e=this;return Object(L.jsxs)("div",{className:"select-puzzle-screen",children:[Object(L.jsxs)("div",{className:"puzzle-select-title",children:[Object(L.jsx)("h1",{children:"Puzzle Select"}),Object(L.jsx)("h3",{children:"Select Which Puzzle You Would Like to Go To!"})]}),Object(L.jsx)("div",{className:"home-button-container",children:Object(L.jsx)("button",{className:"home-button-back",onClick:function(t){return e.returnHome(t)},children:Object(L.jsx)("span",{className:"home-button-front",children:"Home"})})}),Object(L.jsx)("div",{className:"select-puzzle-buttons-container",children:this.props.current_pack.seqs.map((function(t){return Object(L.jsxs)("div",{className:"puzzle-select-seq-container",children:[Object(L.jsx)("h2",{children:t.name}),Object(L.jsx)("div",{className:"puzzle-select-buttons",children:t.puzzles.map((function(t){return Object(L.jsx)("button",{className:"puzzle-select-button-back",id:t.tag,value:String(e.props.completed_puzzles.includes(t.name)),onClick:function(t){return e.openPuzzle(t)},children:Object(L.jsx)("span",{className:"puzzle-select-button-front",title:String(e.props.completed_puzzles.includes(t.name)),children:t.name})},t.name)}))})]},t.name)}))})]})}}]),n}(s.a.Component);!function(e){e.Loading="loading",e.Normal="normal",e.PuzzleSelect="puzzleSelect",e.SequencePause="sequencePause",e.PuzzlePause="puzzlePause",e.LearnMore="learnMore"}(Ge||(Ge={}));var Je=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).puzzle_manager=void 0,ge(),a.state={program:U,reset:!1,world:new ye,simulator:new me(new ye,U),lastSavedWorld:void 0,view:Ge.Loading,devMode:!1},a.puzzle_manager=new Ve,a.load_last_progress(),a}return Object(p.a)(n,[{key:"learn_more",value:function(e){this.puzzle_manager.set_pack(e),this.setState({view:Ge.Normal}),this.load_puzzle("puzzles/".concat(this.puzzle_manager.get_current_puzzle().tag,".json"))}},{key:"save_progress",value:function(){var e=JSON.stringify(Object(d.a)(this.puzzle_manager.completed_puzzle));window.localStorage.setItem("progress",e)}},{key:"clean_progress",value:function(){window.localStorage.removeItem("progress"),this.puzzle_manager.completed_puzzle.clear()}},{key:"load_last_progress",value:function(){var e=window.localStorage.getItem("progress");e&&this.puzzle_manager.set_completed_puzzle(new Map(JSON.parse(e)))}},{key:"save_sandbox",value:function(){window.localStorage.setItem("sandbox",Q())}},{key:"load_last_sandbox",value:function(){var e=window.localStorage.getItem("sandbox");e?(console.log("program: "+e),this.setState({program:R(e)},(function(){J(e)}))):J("")}},{key:"load_puzzle",value:function(e){var t=this;Ce.make_from_file(e,(function(){return t.win_puzzle()})).then((function(e){var n=new me(e.start_world,U),a=R(e.start_code);a instanceof I?console.error("Syntax Error: ".concat(a)):(t.puzzle_manager.set_puzzle(e.tag),t.setState({program:a,world:e.start_world,puzzle:e,simulator:n,view:Ge.Normal,reset:!1,lastSavedWorld:void 0}),J(e.start_code))}))}},{key:"load_sandbox",value:function(){this.load_last_progress();var e=new ye;e.mark_dirty();var t=new me(e,R(""));this.setState({world:e,puzzle:Me,simulator:t,view:Ge.Normal,reset:!1,lastSavedWorld:void 0}),this.puzzle_manager.current_puzzle.puz_index=-1,this.puzzle_manager.get_granted_blocks(!1),this.load_last_sandbox()}},{key:"win_puzzle",value:function(){this.puzzle_manager.complete_puzzle(),this.puzzle_manager.check_complete_pack()?this.setState({view:Ge.SequencePause}):this.setState({view:Ge.PuzzlePause}),this.save_progress()}},{key:"toggle_dev_mode",value:function(){this.setState({devMode:!this.state.devMode})}},{key:"componentDidMount",value:function(){var e=this;this.puzzle_manager.initialize().then((function(){e.setState({view:Ge.Normal},(function(){return e.load_puzzle("puzzles/".concat(e.puzzle_manager.get_current_puzzle().tag,".json"))}))}))}},{key:"run_program",value:function(){var e=this;if(this.state.reset)this.setState({world:this.state.lastSavedWorld,lastSavedWorld:void 0},(function(){e.state.world.mark_dirty()}));else{this.setState({lastSavedWorld:z.a.cloneDeep(this.state.world)});var t=R(Q());t instanceof I?console.error("Syntax Error: ".concat(t)):(this.setState({simulator:new me(this.state.world,t)},(function(){return e.state.simulator.set_running()})),this.state.puzzle===Me&&this.save_sandbox())}this.setState({reset:!this.state.reset})}},{key:"continue",value:function(){this.setState({view:Ge.Normal});var e=this.puzzle_manager.next_puzzle();e?this.load_puzzle("puzzles/".concat(e.tag,".json")):this.load_sandbox()}},{key:"on_change_pack",value:function(e){this.puzzle_manager.set_pack(parseInt(e.target.value)),this.load_puzzle("puzzles/".concat(this.puzzle_manager.get_current_puzzle().tag,".json"))}},{key:"current_puzzle",value:function(){return this.state.puzzle===Me?"Sandbox":JSON.stringify(null===(e=this.state.puzzle)||void 0===e?void 0:e.name);var e}},{key:"render",value:function(){var e=this;return this.state.view===Ge.Loading?Object(L.jsx)("h1",{children:"Loading..."}):this.state.view===Ge.PuzzleSelect?Object(L.jsx)(He,{gameState:Object(u.a)({},this.state),current_pack:this.puzzle_manager.get_current_pack(),current_puzzle:this.puzzle_manager.get_current_puzzle(),completed_puzzles:this.puzzle_manager.find_completed_puzzle(),granted_blocks:this.puzzle_manager.get_granted_blocks(this.state.devMode),onClickHome:function(t){e.setState({view:Ge.Normal,devMode:!1}),e.load_puzzle(t)},onClickToPuzzle:function(t){e.setState({view:Ge.Normal,devMode:!1}),e.load_puzzle(t)},loadLastSandbox:function(){e.setState({view:Ge.Normal}),e.load_last_sandbox()}}):this.state.view===Ge.LearnMore?Object(L.jsxs)("div",{className:"LearnMore",children:[Object(L.jsx)("header",{id:"header",children:Object(L.jsx)("div",{children:Object(L.jsx)("h1",{children:"Choose a pack:"})})}),Object(L.jsx)("button",{className:"standard-back",onClick:function(){return e.learn_more(0)},children:Object(L.jsx)("span",{className:"standard-front",children:"Standard"})}),Object(L.jsx)("button",{className:"test-back",onClick:function(){return e.learn_more(1)},children:Object(L.jsx)("span",{className:"test-front",children:"Test"})})]}):Object(L.jsxs)("div",{className:"App",children:[Object(L.jsxs)("header",{id:"header",className:"navbar",children:[Object(L.jsx)("div",{className:"header-name",children:Object(L.jsx)("h1",{children:"Dragon Architect"})}),Object(L.jsxs)("div",{className:"puzzle-selection-name-and-button",children:[Object(L.jsx)("div",{className:"current-puzzle-name",children:Object(L.jsxs)("h5",{children:["Current Puzzle: ",this.current_puzzle()]})}),Object(L.jsx)("div",{className:"puzzle-select-toggle",children:Object(L.jsx)("button",{className:"puzzle-select-toggle-button-back",onClick:function(){return e.setState({view:Ge.PuzzleSelect})},children:Object(L.jsx)("span",{className:"puzzle-select-toggle-button-front",children:"Puzzle Select"})})}),Object(L.jsx)("div",{className:"sandbox-toggle",children:Object(L.jsx)("button",{className:"sandbox-toggle-button-back",onClick:function(){e.load_sandbox()},children:Object(L.jsx)("span",{className:"sandbox-toggle-button-front",children:"Sandbox Mode"})})})]})]}),!1,Object(L.jsx)("div",{id:"main-view-code",children:Object(L.jsx)(ee,Object(u.a)({granted_blocks:this.puzzle_manager.get_granted_blocks(this.state.devMode)},this.state))}),this.state.view===Ge.SequencePause&&this.state.reset&&Object(L.jsxs)("div",{className:"sandbox-congrats-box",children:[Object(L.jsx)("h4",{children:"You finished all puzzles in this sequence!"}),Object(L.jsx)("button",{className:"congrats-button-back",onClick:function(){e.load_sandbox()},children:Object(L.jsx)("span",{className:"congrats-button-front",children:Object(L.jsx)("h2",{children:"Go To Sandbox"})})})]}),this.state.view===Ge.PuzzlePause&&Object(L.jsxs)("div",{className:"congrats-box",children:[Object(L.jsx)("h4",{children:"Good job!"}),Object(L.jsx)("button",{className:"congrats-button-back",onClick:function(){e.continue()},children:Object(L.jsx)("span",{className:"congrats-button-front",children:Object(L.jsx)("h2",{children:"Next Puzzle"})})})]}),Object(L.jsxs)("div",{id:"main-view-game",children:[Object(L.jsx)(Re,Object(u.a)({},this.state)),Object(L.jsx)("div",{id:"instructions-display",className:"goal-section instructions",children:Object(L.jsx)("div",{id:"instructions-goal",children:Object(L.jsx)(Le,{gamestate:this.state})})})]}),Object(L.jsx)("div",{className:"run-button-container",children:Object(L.jsx)(Fe,{gamestate:this.state,onClick:function(){e.run_program()}})})]})}}]),n}(s.a.Component);l.a.render(Object(L.jsx)(s.a.StrictMode,{children:Object(L.jsx)(Je,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.ff041c65.chunk.js.map